{% extends 'base.html.twig' %}

{% block title %}Backoffice · Éditer Clinique{% endblock %}

{% block body %}
<div class="container mt-4">
    <h1>Éditer la Clinique</h1>

    {% for label, messages in app.flashes %}
        {% for message in messages %}
            <div class="alert alert-{{ label == 'error' ? 'danger' : label }}">
                {{ message }}
            </div>
        {% endfor %}
    {% endfor %}

    <div class="card">
        <div class="card-body">
            <form method="post" action="{{ path('backoffice_clinics_update', {id: clinic.id}) }}">
                <input type="hidden" name="_token" value="{{ csrf_token }}">

                <div class="mb-3">
                    <label class="form-label">ID</label>
                    <input class="form-control" value="{{ clinic.id }}" disabled>
                </div>

                <div class="mb-3">
                    <label class="form-label">Nom*</label>
                    <input name="name" class="form-control" value="{{ clinic.name }}" required>
                </div>

                <div class="mb-3">
                    <label class="form-label">Slug* <small>(format: a-z, 0-9, -)</small></label>
                    <input name="slug" class="form-control" value="{{ clinic.slug }}" pattern="[a-z0-9-]+" required>
                </div>

                <div class="mb-3">
                    <label class="form-label">Timezone* <small>(IANA format)</small></label>
                    <input name="time_zone" class="form-control" value="{{ clinic.timeZone }}" required>
                </div>

                <div class="mb-3">
                    <label class="form-label">Locale* <small>(format: fr, en_US)</small></label>
                    <input name="locale" class="form-control" value="{{ clinic.locale }}" pattern="[a-z]{2}(_[A-Z]{2})?" required>
                </div>

                <div class="mb-3">
                    <label class="form-label">Statut*</label>
                    <select name="status" class="form-select" required>
                        <option value="active" {{ clinic.status.value == 'active' ? 'selected' : '' }}>Active</option>
                        <option value="suspended" {{ clinic.status.value == 'suspended' ? 'selected' : '' }}>Suspended</option>
                        <option value="closed" {{ clinic.status.value == 'closed' ? 'selected' : '' }}>Closed</option>
                    </select>
                </div>

                <div class="mb-3">
                    <label class="form-label">Groupe</label>
                    <select name="clinic_group_id" class="form-select" disabled>
                        <option value="">(aucun)</option>
                        {% for group in groups.clinicGroups %}
                            <option value="{{ group.id }}" {{ clinic.clinicGroupId == group.id ? 'selected' : '' }}>{{ group.name }}</option>
                        {% endfor %}
                    </select>
                    <small class="text-muted">Note: Le groupe ne peut être modifié après création</small>
                </div>

                <div class="mb-3">
                    <label class="form-label">Créée le (UTC)</label>
                    <input class="form-control" value="{{ clinic.createdAt }}" disabled>
                </div>

                <div class="mb-3">
                    <label class="form-label">Mise à jour le (UTC)</label>
                    <input class="form-control" value="{{ clinic.updatedAt }}" disabled>
                </div>

                <div class="mt-4">
                    <button class="btn btn-primary" type="submit">Enregistrer</button>
                    <a href="{{ path('backoffice_clinics') }}" class="btn btn-secondary">Annuler</a>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}
